{\bfseriesАннотация} 

{\large В работе рассматривается возможность расширения функциональности 
механизма контроля поведения программ, используемого в SELinux, при 
помощи повышения гранулярности контроля поведения приложений
в указанной системе за счет отслеживания внутреннего состония
программы из ядра. Предлагается делать это при помощи
разметки исполнимого кода приложения контрольными точками 
на уровне исходных текстов. 
}

\newpage
\tableofcontents
\newpage

\bigskip 
\section{Введение.}

Стандартные системы безопасности ОС, основы которых 
были заложены несколько десятилетий назад, давно не 
являются удовлетворительными. Стандартная система 
безопасности Unix предоставляет одинаковые права всем 
пользователям в определенной группе, все процессы, 
запущенные от имени конкретного пользователя, обладают 
его привилегиями. Любая уязвимость становится 
потенциальной причиной компрометации учетной записи 
пользователя. 

В 1985 году был введен стандарт «Критерии 
оценки доверенных компьютерных систем» более известный 
под названием «Оранжевая книга». Данный стандарт получил 
международное признание и оказал сильное влияние на 
последующие разработки в области информационной безопасности. 
Появилось семейство так называемых «trusted» операционных 
систем — TrustedBSD, Trusted Solaris, Trusted UNICOS 8.0, 
HP-UX 10.26, PitBull for AIX 5L, XTS-400. На сегодняшний 
день результатами разработки 
более современных и продвинутых систем безопасности, 
работающие поверх стандартных, стали такие продукты, как 
SELinux (NSA, Red Hat)~\cite{SEOF}, AppArmor (Immulinux, Novell) 
~\cite{AppArmor},
PaX(GRSecurity)\cite{pax}, Seatbelt(Apple). Кроме этого, разработчики 
некоторых систем пытаются расширить стандартные системы 
безопасности, улучшая их и добавляя новые способы защиты.
 


\section{Постановка задачи}
\subsection{Расшифровка темы}
В работе рассматриваются формализованный 
механизм контроля поведения программ, 
используемый в ОС Linux - SELinux.
В задачу входит анализ теоретической базы 
этих механизмов, практический инструментарий
в распространённых дистрибутивах (Debian, 
Ubuntu для AppArmor), достоинства и 
недостатки, в том числе по научной 
литературе. Основная цель данной работы~--- 
повысить гранулярность контроля поведения 
приложений в указанных системах за счёт 
отслеживания внутреннего состояния программы 
из ядра. В рамках работы предполагается делать 
это специальной разметкой программы на уровне 
исходных текстов, а также бинарных патчей (хотя 
бы на уровне исследования). Конечная цель~--- 
автоматизация такой разметки по тестам.

\subsection{Актуальность} 
Существующие механизмы защиты ядра и 
контроля поведения приложений в ОС Linux 
(SELinux, AppArmor) имеют ряд недостатков, 
в частности, используемые в них методы 
выявления аномального поведения приложений 
не учитывают внутреннее состояние защищаемого 
приложения. В ряде случаев это накладывает 
сильные ограничения на допустимое поведение, 
что ограничивает применимость этих механизмов. 
Учёт внутреннего состояния контролируемого 
приложения позволит избежать жёстких обобщённых 
ограничений на его поведение.

\subsection{Цель работы} 
Расширение функциональности систем защиты 
уровня ядра Linux (SELinux) за счёт повышения 
гранулярности отслеживания поведения приложений 
и разделения их внутренних состояний.

\subsection{Постановка задачи}
В рамках работы должны быть решены следующие задачи:
\begin{itemize}
\item Сравнительный анализ систем безопасности 
	уровня ядра ОС Linux.
\item Исследование возможности 
	простановки контрольных точек на уровне 
	исходных текстов и бинарных программ.
\item Разработка программной инфраструктуры 
	поддержки контроля состояния приложения 
	по контрольным точкам для ОС GNU/Linux.
\item Расширение профилей SELinux, добавление 
	возможности переключения контекста безопасности 
	при изменении состояния приложения.
\end{itemize}
\bigskip

\section{Существующие системы безопасности уровня ядра ОС}

%add refs
\bigskip
Рассмотрим некоторые системы безопасности, 
приведенные выше. 
Так как решение задачи контроля за 
текущим состоянием приложения планируется
реализовать с использованием SELinux, 
будет рассмотрена архитектура этой системы 
и системы AppArmor, которая является во 
многом схожей с SELinux. 

Кроме этого, кратко будут рассмотрены особенности 
систем PaX и TrustedBSD.

\bigskip
\subsection{SELinux} 
SELinux является системой безопасности 
уровня ядра Linux, основанной на 
подсистеме LSM. LSM позволяет 
создвать модули безопасности. Данные модули 
должны реализоывать 
определенную логику принятия решений о 
разрешении или запрещении различных 
взаимодействий между объектами и субъектами 
системы. 

Под объектами системы здесь 
понимаются файлы, объекты межпроцессного 
взаимодействия, объекты сетевого взаимодействия 
и прочие. Субъекты представляют собой 
пользовательские процессы, демоны, ядро и.т.д..

SElinux обеспечивает возможность 
комплексной защиты системы, ограничивая поведение 
приложений и пользователей в рамках политик 
безопасности. В первую очередь SELinux 
направлена на борьбу с успешными атаками, 
в частности, с «атаками нулевого дня», когда 
уязвимость уже известна злоумышленнику, 
но лекарства еще не было выпущено. В таких 
случаях уязвимость локализируется на уровне 
политики. Компания Tresys ведет подсчет 
конкретных случаев угроз безопасности, которые, 
в частности, могли быть предотвращены SELinux. 
В их числе: переполнение буфера в Samba (may 
2007), Apache DoS (jun 2007), Mambo exploit (jul 
2007), hplip Security flaw (oct 2007). 

Конфигурация политик является 
сложной задачей из-за необходимости
описывать профили для каждого прилоежния 
вручную на на специальном языке описания
политик. Добавление новых профилей может повлечь 
за собой необходимость в модификации уже имеющихся 
профилей, что может привести к появлению 
ошибок и росту накладных расходов на 
администрирование системы.  

\bigskip
{\bfseries Основные понятия. }

\bigskip
Принудительное присвоение типов (TE). 

Основной идеей принудительного присвоеня
типов является явная разметка всех объектов 
в системе специальными структурами данных 
(метками безопасности), хранящими в себе информацию
об атрибутах объекта, используемую при принятии 
решений внутри логики политики. 
Для процессов и объектов используется 
один и тот же тип атрибутов. Поэтому достаточно 
одной матрицы для описания взаимодействий между 
разными типами, при этом объекты одного типа могут 
рассматриваться по-разному, если их их ассоциированные 
классы безопасности различны. Пользователи не 
привязаны к типам безопасности напрямую, вместо 
этого используется RBAC.

\bigskip
Ролевой контроль доступа (RBAC) 

Данный метод используется для определения 
множества ролей, которые могут 
быть назначены пользователям. SELinux расширяет 
модель RBAC до жесткой привязки пользовательских 
ролей к определенным доменам безопасности, роли 
могут быть организованы в виде иерархии приоритетов. 
Такая привязка ролей к доменам позволяет принимать 
большинство решений на основе конфигурации TE. 
Контекст безопасности, кроме всего прочего, включает 
в себя атрибут роли.

\bigskip
Многоуровневая система безопасности (MLS) 

SELinux предоставляет MLS для случаев, когда есть 
необходимость в традиционной многоуровневой системе 
безопасности. У объектов и субъектов могут быть 
различные уровни и категории. 
Как правило, используется лишь один уровень. 

\bigskip
{\bfseries Принципы работы}

Главными элементами системы безопасности 
являются субъект, объект и действия. В классы 
объектов входят классы файлов (blk\_file, chr\_
file, dir, fd,...\ ) ,  классы межпроцессного 
взаимодействия (ipc,msg,msgq,sem,shm), классы 
сетевого взаимодействия (key\_socket,netif,node,
packet\_socket,tcp\_socket), классы объектов 
(passwd), системные классы (capability, process,
Secutity, System). Под субъектами понимаются 
процессы, демоны, ядро и.т.д.. Действия, которые субъекты 
SELinux могут производить над объектами 
различны для различных классов объектов. 
Для классов файлов это, например, 
будут создание, исполнение, ссылки, чтение, запись, 
удаление. 

SELinux ассоциирует атрибуты безопасности 
с субъектами и объектами и основывает свои решения 
на этих атрибутах. Атрибутами являются: идентификатор 
пользователя, роль и тип. Идентификатор пользователя 
— пользовательская учетная запись, ассоциированная с 
субъектом или объектом. У каждого пользователя может 
быть несколько ролей, но в какой-то конкретный момент
времени ему может быть предписана только одна из них. 
Пользователь может менять роли командой newrole. Типы 
(для процессов~--- Домены) делят субъекты и объекты на родственные 
группы. Это~--— главный атрибут безопасности, используемый 
SELinux для принятия решений. 

Типы позволяют помещать 
процессы в «песочницы» и предотвращать повышение 
привилегий. К примеру, роль суперпользователя - 
sysadm\_r, его тип — sysadm\_t. Политика безопасности 
SELinux загружается системой из бинарного файла политики,
который, как правило, находится в /etc/selinux. 
Бинарная политика собирается при помощи make, исходные 
коды, как правило, находятся в /etc/selinux/\$(POLNAME)/src/policy.

Инструменты работы с SELinux могут быть разделены на 
три категории: специальные утилиты для настройки и 
ипользования SELinux, модифицированные версии стандартных 
команд и программ Linux, некоторые добавочные инструменты,
к примеру, для настройки и анализа политик. Среди основных 
команд можно выделить следующие: chcon – помечает файл или 
группу файлов указанным контекстом безопасности, checkpolicy
– позволяет выполнять множество действий, связанных с 
политиками, в том числе, компиляцию политики и ее загрузку 
в ядро; getenforce — позволяет узнать в каком режиме 
работает SELinux, newrole – позволяет пользователю 
перемещаться между ролями; run\_init — позволяет 
запускать, останавливать или контролировать сервис; 
setenforce позволяет менять режим работы системы; 
setfiles присваивает метки указанной директории и ее 
поддиректориям. Некоторые из измененных программ: cron, 
login, logrotate, pam, ssh. Некоторые инструменты: Apol 
– инструмент для анализа файла policy.conf; SeAudit – 
инструмент для анализа логов, имеющий графический интерфейс; 
SeCmds; SePCuT — инструмент для просмотра и редактирования 
файлов политик; SeUser — модификация пользовательских 
учетных записей. 

\bigskip
{\bfseries Методы контроля за внутренним 
состоянием приложения} 

SELinux предоставляет разработчикам приложений 
инструментарий, позволяющий создавать более 
безопасные приложения путем изменения текущих
привилегий приложения во время его исполнения. 
Последнее реализуется путем изменения домена приложения. 
Приложение должно запросить у ядра ОС смену своего 
текущего домена на указанный. При этом возможность
такой смены доменов должна быть явно описана в 
политике безопасности. Далее данный метод будет
рассмотрен более подробно.  
\bigskip
