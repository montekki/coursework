{\bfseriesАннотация} 

{\large В работе рассматривается возможность расширения функциональности 
механизма контроля поведения программ, используемого в SELinux, при 
помощи повышения гранулярности контроля поведения приложений
в указанной системе за счет отслеживания внутреннего состония
программы из ядра. Предлагается делать это при помощи
разметки исполнимого кода приложения контрольными точками 
на уровне исходных текстов. В работе приводится сравнительный 
анализ систем безопасности уровня ядра, описание разработки 
инструментальной системы для проставления контрольных точек 
в программах и использование существующих средств для добавления
состояний контролируемых приложений. 
}

\newpage
\tableofcontents
\newpage

\bigskip
\section{Обзор существующих систем безопасности уровня ядра ОС}
\subsection{Введение}

Стандартные системы безопасности ОС, основы которых 
были заложены несколько десятилетий назад, давно не 
являются удовлетворительными. Стандартная система 
безопасности Unix предоставляет одинаковые права всем 
пользователям в определенной группе, все процессы, 
запущенные от имени конкретного пользователя, обладают 
его привилегиями. Любая уязвимость становится 
потенциальной причиной компрометации учетной записи 
пользователя. В 1985 году был введен стандарт «Критерии 
оценки доверенных компьютерных систем» более известный 
под названием «Оранжевая книга». Данный стандарт получил 
международное признание и оказал сильное влияние на 
последующие разработки в области информационной безопасности. 
Появилось семейство так называемых «trusted» операционных 
систем — TrustedBSD, Trusted Solaris, Trusted UNICOS 8.0, 
HP-UX 10.26, PitBull for AIX 5L, XTS-400. На сегодняшний 
день результатами попыток различных разработчиков создать 
более современные и продвинутые системы безопасности, 
работающие поверх стандартных, стали такие продукты, как 
SELinux (NSA,Red Hat), AppArmor (Immulinux, Novell), 
PaX(GRSecurity), Seatbelt(Apple). Кроме этого, разработчики 
некоторых систем пытаются расширить стандартные системы 
безопасности, улучшая их и добавляя новые способы защиты, 
как это происходит с Windows (Vista). 

\bigskip
Рассмотрим самые значимые и распространенные системы из
 перечисленных и сравним их по некоторым критериям, о 
которых речь пойдет ниже.


Рассмотренные системы безопасности уровня ОС 
Было рассмотрено 7 систем безопасности уровня ОС. 
В таблице 1.1 приведена краткая информация по каждой из них. 

\bigskip
\begin{tabular}{|p{4cm}|p{3cm}|p{6cm}|}
\hline
Название системы & Производитель & Ссылки \\
\hline
AppArmor & Novell & http://www.novell.com/linux/se
curity/apparmor/ \\
\hline
Selinux & Red Hat & http://www.nsa.gov/selinux/\\
\hline
PaX & GRSecurity & http://pax.grsecurity.net/\\
\hline
Trusted BSD & Trusted BSD & http://www.trustedbsd.org/\\
\hline 
Trusted Solaris & SUN & http://www.sun.com/software/s
olaris/trustedsolaris/index.xml\\
\hline
СБ ОС Феникс & СЦЗИ СПбГТУ & http://www.ssl.stu.neva.ru/fenix\\
\hline
Vista kernel security & Microsoft & http://www.microsoft.com\\
\hline
\end{tabular}
Таблица 1.1
\bigskip 
\subsection{Критерии сравнения}

Для сравнительного анализа были выбраны следующие критерии: 
\begin{itemize}
	\itemКласс угроз. Классы угроз, которым способна 
	противостоять система. Большинство из рассмотренных
	систем не способны противостоять угрозам всех классов. 
	Поэтому на практике часто требуется комбинировать различные СБ. 
	\itemПредоставляемые системой методы защиты. Описывает 
	методы, которые СБ способна предложить для защиты от 
	различных классов угроз. 
	\itemУдобство настройки и использования. Чем сложнее
	настройка и использование системы, тем выше вероятность 
	неверной конфигурации и отказа системы. Данный критерий 
	отвечает за то, насколько легко производить настройку. 
\end{itemize}

\bigskip
\subsection{Результаты сравнения.} 

{\bfseries Класс угроз.}

\bigskip

{\bfseries SELinux} 
Предоставляет возможность для комплексной 
защиты системы, ограничивая поведение 
приложений и пользователей в рамках политик 
безопасности. В первую очередь SELinux 
направлена на борьбу с успешными атаками, 
в частности, с «атаками нулевого дня», когда 
уязвимость уже используется злоумышленником, 
но лекарства еще не было выпущено. В таких 
случаях уязвимость закрывается на уровне 
политики. Компания Tresys ведет подсчет 
конкретных случаев угроз безопасности, которые, 
в частности, могли быть предотвращены SELinux. 
В их числе: переполнение буфера в Samba (may 
2007), Apache DoS (jun 2007) Mambo exploit (jul 
2007), hplip Security flaw (oct 2007). SELinux 
при необходимости может быть использована для 
снижения вероятности инсайдерских атак, к примеру, 
менеджер архивов может архивировать файлы, но иметь 
к ним доступ на чтение ему совершенно не обязательно. 

\bigskip
{\bfseries AppArmor}
По классам угроз во многом схож с SELinux, 
предоставляя возможности для изоляции приложений, 
подверженных эксплойтам. Эти две системы можно 
охарактеризовать как довольно универсальные, 
без ярко выраженного направления атак, от которых 
они защищают.

\bigskip
{\bfseries PaX } 
Существует три класса угроз, предотвращением которых 
занимается PaX. Это внедрение и исполнение кода с 
повышенными привилегиями, исполнение кода самого 
процесса путем изменения нормального течения 
исполнения процесса, нормальное исполнение программы, 
но над данными, для которых предусмотрены повышенные 
привилегии. Non-executable pages (NOEXEC) и mmap/mprotect 
(MPROTECT) предотвращают атаки первого класса. За одним 
исключением: если злоумышленник имеет право на 
создание/запись в файл на атакуемой машине и mmap() 
его в атакуемый процесс, у него появляется возможность 
внедрения кода. Address Layout Randomisation (ASLR) 
позволяет предотвратить все три класса атак в той 
ситуации, когда атакующий заранее закладывается на 
адреса в атакуемом процессе и не может узнать о них 
в процессе исполнения. Так как PaX полностью внедрен 
в ядро, предполагается то, что ядро является Trusted 
Computer Base. 

\bigskip
{\bfseries Windows Vista kernel level Security Model }
Система безопасности Vista защищает от атак на 
драйверы и от изменения системных объектов. 

\bigskip
{\bfseries Trusted BSD} 
Класс атак аналогичен классам SELinux и AppArmor. 

\bigskip
{\bfseries ОС Феникс }
На данный момент Феникс находится в стадии разработки. 
Микроядро обеспечивает изоляцию адресных пространств 
процессов, тем самым предотвращая изменение одного 
процесса другим. Кроме этого, обеспечивается доверенность 
сообщений, то есть, сообщения между процессами не могут 
быть подделаны 

\bigskip
{\bfseries Apple Seatbelt}

Аналогично TrustedBSD, SELinux, AppArmor.

\bigskip
\subsection{Предоставляемые системой методы защиты.}

\bigskip
{\bfseries SELinux} является модулем LSM. 
Предоставляет набор измененных системных утилит, 
внедряет вызовы в ядро (hooks). Если приложение 
пытается выполнить какое-либо действие, критичное 
для безопасности и если это действие разрешено на 
уровне стандартной системы безопасности Unix, 
ядро обращается к SELinux за решением. Решение 
принимается на уровне политики безопасности. 

\bigskip
{\bfseries AppArmor} является модулем LSM так же, 
как и SELinux. AppArmor контролирует поведение 
приложений, опираясь на политики, которые являются 
текстовыми файлами, удобными к восприятию и редактированию. 
В данных файлах хранится информация, основанная на 
путях к объектам в файловой системе, о том, к каким 
объектам и с какими правами имеет доступ приложение. 
Кроме этого AppArmor предоставляет инструменты 
автоматической генерации профилей на основе поведения 
приложения и возможность производить контроль в двух 
режимах: режиме обучения и режиме принуждения. 

\bigskip
{\bfseries Vista} защищает свои системные структуры 
и процессы от изменения злоумышленником. Для этого 
ей служат инструменты контроля целостности файлов 
и процессов, контроля доступа к памяти, система 
цифровых подписей для драйверов. 

\bigskip
{\bfseries ОС Феникс.} Основой средств защиты является 
монитор взаимодействий — специальный компонент, 
работающий в связке с ядром и осуществляющий контроль 
взаимодействий в соответствии с политикой безопасности 
и поставляющий информацию для протокола аудита. Поскольку 
монитор взаимодействий не реализует никакой модели 
безопасности, а только контролирует операции УНИДО, 
для принятия решения о доступе он взаимодействует со 
специальным набором компонентов, обеспечивающих возможность 
реализации любой модели безопасности, основанной на 
отношениях субъект-объект и атрибутах безопасности. 

\bigskip
{\bfseries Trusted BSD.} Списки контроля доступа позволяют 
контролировать взаимодействия между объектами и субъектами
в системе, основываясь на некоторой добавочной информации 
о них. Контроль производится при помощи Mandatory Access 
Control Framework. Кроме этого система предоставляет широкие 
возможности аудита событий безопасности. 

\bigskip
{\bfseries PaX} предлагает механизмы для защиты от 
исполнения стека, рандомизации размещения адресов внутри 
адресного пространства (address space layout randomization) . 

\bigskip
{\bfseries Apple MAC} представляет собой порт интерфейсов 
TrustedBSD MAC. На них базируется модуль безопасности 
Seatbelt. Модули из TrustedBSD и SEDarwin пока остаются 
за пределами системы безопасности Mac OS Leopard. Используя 
данный модуль возможно как повышение уровня безопасности 
приложения программистом, так и контроль за выполнением 
приложения, нормальный ход которого описывается в 
специальных файлах конфигурации политики.

