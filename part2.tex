\subsection{AppArmor}

AppArmor является системой безопасности уровня 
ядра ОС Linux, разрабатываемой компанией Novell. 
AppArmor использует LSM аналогично SELinux. 

Тем не менее, данная система безопасности не использует
явную разметку всех объектов в системе.
Вместо этого она контролирует поведение 
приложений, опираясь на профили поведения
приложений, описанные на некотором интерпретируемом
языке. 
В данных файлах хранится информация, основанная на 
путях к объектам в файловой системе, о том, к каким 
объектам и с какими правами имеет доступ приложение. 

В отличие от SELinux'а, 
в котором настройки глобальны для всей системы, профили 
AppArmor разрабатываются индивидуально для каждого 
приложения.
Таким образом, гораздо меньше вероятность 
необходимости изменения существующих профилей при 
генерации новых профилей. Кроме этого, 
AppArmor предоставляет инструменты 
автоматической генерации профилей на основе поведения 
приложения и возможность производить контроль в двух 
режимах: режиме обучения и режиме принуждения. 

\bigskip
{\bfseries Реализованные модели безопасности.} 

В AppArmor реализовано принудительное присвоение типов. 

\bigskip
{\bfseries Наличие возможности изменять матрицу доступа 
	во время исполнения} 

Это возможно сделать путем редактирования конфигурационных
файлов политики. 

\bigskip
{\bfseries Классы вредоносных действий, предотвращаемых
	системой безопасности} 

Аналогично СБ SELinux, AppArmor позволяет 
минимизировать ущерб от успешных атак на систему. 
Контроль за всеми событиями в системе производится 
на основании определенной администратором политики 
безопасности. 

\bigskip
{\bfseries Возможность динамической смены 
контекстов приложения} 

Система предоставляет возможность смены
текущих привилегий для веб-сервера Apache
(Change Hat). Тем не менее, из-за фактического
прекращения разработки AppArmor данная 
система так и не стала доступной для использования
с произвольным приложением. 


\begin{comment}
AppArmor является системой безопасности, поддерживаемой 
компанией Novell, включена в дистрибутивы openSUSE и SUSE 
Enterprise.  Изначально в AppArmor включен набор 
стандартных профилей, запускаемых после установки. 
Отдельно доступны профили для разных популярных программ 
и серверов. Кроме этого, существуют инструменты для генерации 
профилей (genprof и logprof). Основная идея — верный выбор 
приложений, нуждающихся в ограничении привилегий и 
создание/редактирование профилей безопасности. Таким 
образом, в случае эксплуатации злоумышленником 
уязвимости,  нанесенный ущерб сводится 
к минимуму. 

Система может работать в двух режимах: режиме 
обучения (complain) и в принудительном режиме (enforce). 
В первом из них все нарушения правил профиля разрешены, 
но немедленно регистрируются. Загрузка профиля в 
принудительном режиме предписывает системе отправлять 
сообщения о нарушениях в syslogd. Запуск и остановку 
AppArmor можно осуществлять при помощи команды rcapparmor 
с одним из следующих параметров: start (загрузка модуля 
ядра, анализ профиля, монтирование своей фс); stop (фс 
размонтируется, профили становятся недействительными); 
reload (перезагрузка профилей), status (информация о 
количестве запущенных профилей, в каком режиме они 
работают). Инструменты командной строки AppArmor: autodep 
(создает приблизительный профиль для программы или 
рассматриваемого приложения); complain (устанавливает 
профиль AppArmor в обучающий режим); enforce (переводит 
профиль в принудительный режим); genprof (генерирует профиль,
программа указывается при запуске); logprof (управляет
профилями AppArmor); unconfined (выводит список процессов 
с портами tcp и udp, которые не имеют загруженных 
профилей AppArmor). Система AppArmor построена на системе 
полных путей к файлам, проще говоря, типичное описание 
профиля выглядит примерно так: 

\bigskip
\begin{lstlisting}
#include <tunables/global>  
/usr/bin/man { 
	#include <abstractions/base>
	#include <abstractions/nameservice>
	capability setgid,
	capability setuid,
	/usr/lib/man-db/man Px,} 
}
\end{lstlisting}

\bigskip
Профиль состоит из записей, которые содержат 
полные пути до файлов или каталогов 
каталогов с указанием полных и указания прав
доступа к ним. При этом r~--— 
разрешение на чтение, w~--— запись(за исключением создания 
и удаления файлов), ix~--— исполнение и наследование текущего 
профиля, px~--— исполнение под специфическим профилем, Px — 
защищенное выполнение, ux — неограниченное исполнение, 
Ux~--- защищенное неограниченное исполнение, m~--— присвоение 
участку памяти атрибута "исполняемый", I~--— жесткая ссылка. 
Чтобы подключить готовый профиль к AppArmor, достаточно его 
скопировать в каталог /etc/apparmor.d. 

\end{comment}
\bigskip
\subsection{GRSecurity} 
 
GRSecurity является набором патчей ядра Linux.
Основными отличительными чертами данной системы 
безопасности являются возможность функционировать 
без настройки, защита от всех видов уязвимостей, 
связанных с модификацией адресного пространства 
процесса, возможность определять списки доступа и 
способность функционировать на различных аппаратных 
архитектурах. 

Обнаружение атак на приложения осуществляется
системой аудита. Механизм предотвращения атак 
реализован в PaX. Механизм ограничения действий 
приложений реализован в списках контроля доступа
(Access Control Lists). 

ACL представляет собой  вариант матрицы контроля доступа, где с 
каждым объектом ассоциируется множество пар. 
Каждая из этих пар содержит субъект и набор правил. 

PaX является набором патчей ядра, которые позволяют 
предотвращать атаки, связанные с модификацией адресного
пространства приложений. 
Существует три класса угроз, предотвращением которых 
занимается PaX. Это внедрение и исполнение кода с 
повышенными привилегиями, исполнение кода самого 
процесса путем изменения нормального течения 
исполнения процесса, нормальное исполнение программы, 
но над данными, для которых предусмотрены повышенные 
привилегии. 

\begin{comment}
Non-executable pages (NOEXEC) и mmap/mprotect 
(MPROTECT) предотвращают внедрение и исполнение 
кода с повышенными привилегиями. 
Address Layout Randomisation (ASLR) 
позволяет предотвратить все три упомянутые вида атак в той 
ситуации, когда атакующий заранее закладывается на 
адреса в атакуемом процессе и не может узнать о них 
в процессе исполнения. Так как PaX полностью внедрен 
в ядро, предполагается то, что ядро является Trusted 
Computer Base. Инструментарий позволяет предотвратить 
исполнение стека, обеспечить рандомизацию 
размещения адресов внутри адресного пространства 
(address space layout randomization) . 
Основная цель данного проекта — изучение различных защитных 
механизмов, защищающих от эксплойтов уязвимостей ПО, которые 
предоставляют злоумышленнику полные права на чтение/запись в 
системе. Исполнение кода связано с необходимостью изменять 
ход выполнения процесса используя уже существующий код. Одна 
из основных проблем — подмена адресов возврата из функций и 
подмена самих адресов функций. Для установки PaX требуется 
наложить патч на дерево исходных кодов ядра, после чего собрать 
ядро и установить в систему. 
\end{comment}

Несмотря на то, что система может функционировать 
без дополнительного администрирования политики 
безопасности, при необходимости, можно вносить 
изменения в политику. Во многом язык описания 
политик схож с языком в AppArmor. 

\bigskip 
{\bfseries Реализованные модели безопасности} 

В GRSecurity реализована модель принудительного контроля 
доступа на основании списков контроля доступа (ACL).
Кроме этого, реализованы методы рандомизации ключевых 
локальных и сетевых информационных данных, 
ограничения на /proc, контроль сетевых сокетов, 
добавочные функции аудита.   

\bigskip 
{\bfseries Наличие возможности изменять матрицу доступа во время 
	исполнения} 

Отсутствует.

\bigskip 
{\bfseries Возможность динамической смены контекстов приложения} 

Отсутствует. 

\bigskip
{\bfseries Классы вредоносных действий, предотвращаемых 
	системой безопасности.} 

Позволяет заблокировать вредоносные действия, связанные 
с модификацией содержимого памяти внедрением вредоносоного 
кода и последующим его исполнением. 

К классам предовращаемых вредоносных действий относятся 
\begin{itemize} 
\item Внедрение кода в приложение. 
\item Изменение нормального течения исполнения процесса. 
\item Исполнение программы с повышенными привилегиями. 
\end{itemize} 

\bigskip
\subsection{Trusted BSD} 

TrustedBSD является проектом разработки 
расширения существующей системы 
безопасности FreeBSD, который включает 
в себя  расширенные атрибуты UFS2, 
списки контроля доступа, OpenPAM, аудит событий 
безопасности с OpenBSM, мандатное управление доступом 
и TrustedBSD MAC Framework. 
Расширенные атрибуты UFS2 позволяют ядру и 
пользовательским процессам помечать файлы 
именованными метками. В этих метках
хранятся данные, необходимые системе безопасности. 
ACL и метки MAC в их числе. Списки контроля доступа являются 
 расширениями дискреционного контроля доступа. Аудит 
системных событий позволяет вести избирательный 
аудит важных системных событий для последующего 
анализа, обнаружения вторжений, и мониторинга  
. Начиная с версии 5.0 в ядре FreeBSD 
появилась поддержка MAC Framework, прошедшая испытания 
в TrustedBSD. Данная подсистема позволяет создавать политики, 
определяющие принудительное присвоение доменов и типов (DTE), 
многоуровневую систему безопасности (MLS). MLS  
предоставляет интерфейсы управления этой подсистемой, примитивы 
для синхронизации, механизм регистрации политик, примитивы 
для разметки объектов системы, разные политики, 
реализованные в виде модулей политики MAC и набор 
системных вызовов для приложений. При регистрации 
политики, происходит регистрация специальной структуры 
(struct mac\_policy\_ops), содержащей функции MAC 
framework, реализуемые политикой. 

\begin{comment}
На данный момент 
существуют следующие политики: 

mac\_biba – Реализация политики Biba, во многом 
схожей с MLS. Позволяет присваивать объектам и 
субъектам системы атрибуты доступа, которые образую 
иерархию уровней. Все операции над информацией в 
системе контролируются исходя из уровней 
взаимодействующих сущностей. 

mac\_ifoff позволяет администраторам контролировать 
сетевой трафик. 

mac\_lomac (Low-watermark MAC) еще одна 
реализация многоуровневого контроля доступа. 

mac\_bsdextended (file system firewall) Система 
защиты файлов, основанная на определении прав 
доступа на основании роли пользователя. 

mac\_mls реализация политики MLS. Объекты 
классифицируются некоторым образом, субъектам 
присваивают уровень доступа. 
\end{comment} 

\bigskip 
{\bfseries Реализованные модели безопасности}

В системе реализованы списки контроля доступа (ACL), 
мандатный контроль доступа (MAC), аудит событий
безопасности. 

\bigskip
{\bfseries Наличие возможности менять матрицу доступа 
	 во время исполнения } 
	 
Такая возможность отсутствует. 

\bigskip  
{\bfseries Возможность динамической смены контекстов приложения} 

Фреймворк MAC позволяет реализовать в модуле 
безопасности возможность изменения приложением 
собственных прав. При этом, аналогично SELinux, 
приложение должно быть модифицировано соответствующим 
образом для использования данной возможности. 

\bigskip
{\bfseries Классы угроз} 

Аналогично SELinux и AppArmor, TrustedBSD позволяет 
накладывать жесткие ограничения на поведение приложений. 
Эти ограничения описываются в политике безопасности системы.
Основной целью ограничения поведения приложений является 
минимизация ущерба от атак "нулевого дня". 

\newpage
\subsection{Результаты рассмотрения существующих 
систем безопасности} 

\begin{scriptsize}
\bigskip
\begin{center}
\begin{tabular}{|p{2cm}|p{2.5cm}|p{3cm}|p{3cm}|p{3cm}|} 
\hline
Система Безопасности & Модели & Возможность менять матрицу 
доступа в процессе выполнения & 
Динамическая смена контекстов & Классы вредоносных действий,
предотвращаемых системой \\
\hline 
SELinux & TE, MAC, RBAC & Существует & Существует & 
Минимизация ущерба от успешных атак \\
\hline
AppArmor & TE & Существует & Существует только для сервера Apache & 
Минимизация ущерба от успешных атак \\ 
\hline 
GRSecurity & ACL & Отсутствует & Отсутствует & Внедрение кода в приложение 
и его исполнение, изменение нормального течения исполнения приложения, 
исполнение с повышенными привилегиями \\ 
\hline 
Trusted BSD & MAC, ACL, RBAC, Audit & Отсутствует & Существует & 
Минимизация ущерба от успешных атак \\ 
\hline
\end{tabular} 
\end{center} 
\end{scriptsize} 


\bigskip
Существующие системы безопасности уровня ядра ОС Linux 
предоставляют широкие возможности контроля за поведением 
приложений. В частности, SELinux и Trusted BSD 
 предоставляют возможность 
создавать приложения, интегрированные с этими системами 
безопасности. Тем не менее, рассмотренные механизмы уровня 
ОС не позволяют динамически менять права доступа приложения 
в зависимости от его состояния. Данная работа направлена на 
увеличение дискретности контроля поведения приложений за счет 
использования информации об их внутреннем состоянии. 
\bigskip
